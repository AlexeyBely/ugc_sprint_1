# Проектная работа 8 спринта
Репозиторий с работой [ugc_sprint_1](https://github.com/AlexeyBely/ugc_sprint_1)

## Состав проекта

- Исследование: выбор хранилища OLAP. Для исследования выбраны хранилища ClickHouse и Vertica. Результаты представлены в каталоге research_db. По результатам тестов выбран ClickHouse
- Архитектура AS IS и TO BE представлены в каталоге architecture, формат UML
- Сервис UGC

## Сервис UGC

### Порядок запуска

- Запустить хранилище ClickHouse. Описание в каталоге db/clickhouse
- Запустить стриминг событий Kafka. Описание в каталоге db/kafka
- Запустить docker-compose в корневом каталоге

### Описание работы

Для передачи временной метки представлен эндпоинт, в котором передается временная метка и id кинопроизведения. Id пользователя используется из jvt-tokena. Далее временная метка передается в kafka в виде value - "временная метка", key - "user_id+user_movie".

Затем данные из Kafka с помощью ETL сервиса передаются базу данных ClickHouse. Загрузка данных в ClickHouse происходит после накопления заданного количества записей, но не реже заданного временного интервала.

Описание Openapi для сервиса UGC по адресу http://127.0.0.1/ugc/api/openapi

### Использованные технологии
    
- FastAPI
- Kafka 
- ClickHouse
- PlantUML

## Над проектом работали
- Алексей Белоглазов (тимлид) [@AlexeyBely](https://github.com/AlexeyBely)
- Андрей Гуляйко [@gulyayko](https://github.com/gulyayko)
